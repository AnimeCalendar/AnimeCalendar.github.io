"use strict";class Search{constructor(e){this.titleList=e.sort(),this.search=document.getElementById("search"),this.titles=document.getElementById("titles"),this.indexLi=99,this.search.oninput=e=>this.results(e),this.search.onfocus=e=>e.relatedTarget&&e.relatedTarget.className?"active"!=e.relatedTarget.className&&this.results(e):this.results(e),this.search.onkeyup=e=>{switch(e.key){case"Enter":let t=document.getElementById((99==this.indexLi?this.indexLi+1:this.indexLi).toString());this.search.value&&t&&CAL.streamInfo(t.innerHTML),this.search.value="",this.titles.style.display="none",this.search.blur();break;case"Escape":e.target.blur()}},this.search.onkeydown=e=>{switch(e.keyCode){case 38:this.move(-1),e.preventDefault();break;case 40:this.move(1),e.preventDefault()}},this.search.addEventListener("focusout",(e=>{this.titles.style.display="none",e.relatedTarget&&("active"==e.relatedTarget.className?this.titles.style.display="":"titles"==e.relatedTarget.parentElement.id&&e.relatedTarget.click())}))}results(e){let t=e.target.value,s=100;if(this.indexLi=99,t){this.titles.innerHTML="";for(let e of this.titleList)if(e.toLocaleLowerCase().includes(t.toLocaleLowerCase())){let t=document.createElement("li");t.innerHTML=e,t.id=s.toString(),t.tabIndex=s-100,s++,t.onclick=e=>{CAL.streamInfo(e.target.innerHTML),this.search.value="",this.titles.style.display="none"},t.onmousemove=e=>{this.indexLi=parseInt(e.target.id);let t=document.querySelector(".active");t&&(t.className=""),e.target.className="active"},t.oncontextmenu=()=>this.titles.style.display="none",this.titles.append(t)}}this.titles.style.display=s>100?"":"none"}move(e){let t=document.getElementById((this.indexLi+e).toString());t&&(t.className="active",t.focus(),this.search.focus(),t.nextElementSibling&&(t.nextElementSibling.className=""),t.previousElementSibling&&(t.previousElementSibling.className=""),document.getElementById((this.indexLi+e).toString())&&(this.indexLi+=e))}}
