"use strict";class Season{constructor(){this.list=JSON.parse(localStorage.getItem("season"))??{}}async init(){let e=document.createElement("div");e.id="season",e.tabIndex=1,document.body.append(e);let t=await(await fetch("season/shows.json")).json(),n=0;for(let s in t){let r=document.createElement("div");r.className="show-season";let a=document.createElement("table");a.className="info";let i=document.createElement("tr"),l=document.createElement("th");l.innerHTML=s,i.append(l),a.append(i);for(let i in t[s])switch(i){case"cover":let l=document.createElement("div");l.className="cover-season",l.align="right";let o=document.createElement("img");if(o.src=t[s][i],o.width=340,o.height=440,2<n){new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(!e.isIntersecting)return;let n=e.target;n.src=n.src.substring(0,n.src.length-8),t.unobserve(n)}))}),{root:e,rootMargin:"500px 0px"}).observe(o),o.loading="lazy"}else n++;l.append(o),r.append(l);break;case"Genres":a.append(this.row(i,t[s][i].join(", ")));break;default:a.append(this.row(i,t[s][i]))}let o=document.createElement("button");o.innerHTML=s in this.list?"Remove":"Add",o.onclick=e=>{let t=e.srcElement.previousElementSibling.childNodes[0].innerText;t in this.list?(delete this.list[t],e.srcElement.innerHTML="Add"):(this.list[t]=null,e.srcElement.innerHTML="Remove"),localStorage.setItem("season",JSON.stringify(this.list))},r.append(a),r.append(o),e.append(r)}}row(e,t){let n=document.createElement("tr"),s=document.createElement("td");return s.innerHTML=e+": "+t,n.append(s),n}}
