function clear(){$("#clear").css({visibility:"hidden"}),$("#show").remove(),$("#calendar").css({height:"50rem"})}function list(){"Full List"==$("#list")[0].innerHTML?($("#list")[0].innerHTML="Your List",localStorage.setItem("list","Your List")):($("#list")[0].innerHTML="Full List",localStorage.setItem("list","Full List")),TheBigBang()}function left(){""==$("#left")[0].style.display&&(""==$("#right")[0].style.display?($("#left").hide(),TheBigBang(-7)):($("#soon").remove(),$("#right").show(),$("#left").show(),TheBigBang()))}function right(){""==$("#right")[0].style.display&&(""==$("#left")[0].style.display?($("#right").hide(),$("#calendar").remove(),document.getElementById("month").textContent="Spring 2021",$("body").append('<div id="soon" class="content" align="center">Coming Soon</div>')):($("#right").show(),$("#left").show(),TheBigBang()))}function TheBigBang(e=0){$("#calendar").remove(),updateTime();var t=localStorage.getItem("format");let s;switch(t){case"1":s="./shows/cutoff.json";break;case"2":s="./shows/compact.json";break;default:s="./shows/full.json"}fetch(s).then((function(e){return e.json()})).then((function(s){var a=JSON.parse(localStorage.getItem("min"));"Your List"==localStorage.getItem("list")||"0"==t||null==a?$("body").append(calendar(getDates(e),s)):"1"==t?$("body").append(calendar(getDates(e),cutoff(s))):compact(s,e),resizeCalendar(),shows()}))}function calendar(e,t){var s='<div id="calendar"><table><thead><tr><td class="date"></th>';e.forEach((async function(e){s+='<td class="date">'+e.getDate()+" ",s+=e.toLocaleDateString("en-US",{weekday:"long"})+"</td>"})),s+="</tr></thead><tbody>",t.forEach((async function(t){s+='<tr><td class="time">'+t+"</td>";for(let n=0;n<7;n++){var a=e[n];s+='<td class="slot" id="'+ider_slot(a.toLocaleDateString("en-US",{weekday:"long"}),t)+'"></td>'}s+="</tr>"})),s+="</tbody></table></div>";var a=document.getElementById("month");return e[0].getMonth()==e[6].getMonth()?a.innerHTML=e[0].toLocaleDateString("en-US",{month:"long"}):a.innerHTML=e[0].toLocaleDateString("en-US",{month:"long"})+" to "+e[6].toLocaleDateString("en-US",{month:"long"}),s}function getDates(e=0){var t=[],s=new Date,a=s.getDate(),n=s.getMonth(),o=s.getFullYear();switch(s.getDay()){case 0:a+=e-6;break;case 1:a+=e;break;case 2:a+=e-1;break;case 3:a+=e-2;break;case 4:a+=e-3;break;case 5:a+=e-4;break;case 6:a+=e-5}for(let e=0;e<7;e++)t.push(new Date(o,n,a+e));return t}function ider_slot(e,t){var s=1e4*{Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Sunday:7}[e];return":"==t.substring(1,2)?(s+=100*parseInt(t.substring(0,1)),(s+=parseInt(t.substring(2,4)))+t.substring(5,6)):(s+=100*parseInt(t.substring(0,2)),(s+=parseInt(t.substring(3,5)))+t.substring(6,7))}function ider_show(e){let t=e.split(" ");return e.length+t.length.toString()+t[t.length-1].replace(/\W/g,"")}function shows(){fetch("./shows/shows.json").then((function(e){return e.json()})).then((function(e){const t=JSON.parse(localStorage.getItem("shows"));for(let n in"Your List"==document.getElementById("list").innerHTML?e:t){var s="";null!=t&&n in t&&(s=' style="border-color: #4f004f;" ',(null==$("#left")[0].style[0]?t[n][0]:t[n][1])&&(s=' style="border-color: #4f004f; color: #4f4f4f;" '));var a="#"+ider_slot(e[n].day,e[n].time);$(a).append('<a href="'+a+'"><button id="'+ider_show(n)+'" class="show"'+s+">"+n+"</button></a>")}$("#show-js").remove(),$("html").append('<script id="show-js" src="js/show.js"><\/script>')}))}function cutoff(e){var t=JSON.parse(localStorage.getItem("min")),s=JSON.parse(localStorage.getItem("max"));for(const[a,n]of e.entries())if(t[1]==n&&(t=a),s[1]==n){s=a+1;break}return e.slice(t,s)}function compact(e,t){fetch("./shows/shows.json").then((function(e){return e.json()})).then((function(s){var a=[];const n=JSON.parse(localStorage.getItem("shows"));for(let t in e){for(let o in n)if(s[o].time==e[t]){a.push(e[t]),delete n[o];break}if(0==n.length)break}$("body").append(calendar(getDates(t),a)),resizeCalendar()}))}function resizeCalendar(){0!=Object.keys($("#show")).length&&"0"==$("#info")[0].value?$("#calendar").css({height:"25rem"}):$("#calendar").css({height:"50rem"})}function streamInfo(e,t){$("#show").remove(),$(".arrow").off("click.arrow");var s='<table class="table table-hover"><tbody><tr><td id="title">'+t+"</td></tr>";if(0==Object.keys(e[t].streams).length)s+='<tr><td>Streams not available</td></tr><tr><td><img id="cry"src="https://giffiles.alphacoders.com/349/34979.gif"></td></tr>';else for(const[a,[n,o]]of Object.entries(Object.entries(e[t].streams))){switch(s+="<tr><td>"+(parseInt(a)+1)+' <a id="'+a+'"class="stream" href="'+o+'" target="_blank">',n){case"Crunchyroll":s+='<img class="icon" src="assets/crunchyroll.svg">';break;case"Funimation":s+='<img class="icon" src="assets/funimation.svg">';break;case"VRV":s+='<img class="icon" src="assets/vrv.svg">';break;case"AnimeLab":s+='<img class="icon" src="assets/animelab.svg">';break;case"Hulu":s+='<img class="icon" src="assets/hulu.svg">';break;case"HiDive":s+='<img class="icon" src="assets/hidive.svg">';break;case"Wakanim":s+='<img class="icon" src="assets/wakanim.svg">';break;case"YouTube":s+='<img class="icon" src="assets/youtube.svg">';break;case"Netflix":s+='<img class="icon" src="assets/netflix.svg">'}s+=" "+n+"</a></td>"}var a=JSON.parse(localStorage.getItem("shows"));const n=t in a?'<button id="sub" class="setter">Remove from Your List</button>':'<button id="add" class="setter">Add to Your List</button>',o=t in a&&(null==$("#left")[0].style[0]?a[t][0]:a[t][1])?'<button id="reset" style="visibility: visible;">Reset</button>':'<button id="reset" style="visibility: hidden;">Reset</button>';switch(localStorage.getItem("info")){case null:case"0":$("#content").append('<h3 id="show">'+n+o+'<div id="cover"><img src="'+e[t].cover+'" width="340" height="440"></div><div id="streams">'+s+"</div>");break;case"1":$("#content").append('<aside id="show"><h2>'+s+"</h2></aside>"),$("#show").append(n+o);break;case"2":$("#content").append('<h3 id="show" class="window container">'+n+o+'<div id="cover"><img src="'+e[t].cover+'" width="340" height="440"></div><div id="streams">'+s+"</div>")}switch(localStorage.getItem("info")){case null:case"2":case"0":$("#reset").css({position:"absolute"}),$(".icon").css({height:"2rem",width:"2rem"}),$(".setter").css({"margin-top":"24rem",position:"absolute",padding:"2px 10px"});break;case"1":$(".icon").css({height:"1.5rem",width:"1.5rem"})}resizeCalendar(),$("#clear").css({visibility:"visible"}),$("#list-js").remove(),$("html").append('<script id="list-js" src="js/list.js"><\/script>')}function updateTime(){const e=JSON.parse(localStorage.getItem("time"));if(null!=e){var t=JSON.parse(localStorage.getItem("shows")),s=new Date;if((s=[s.getWeek(),s.getFullYear()])[0]-e[0]==1&&s[1]==e[1]||s[1]-e[1]==1&&52==s[0])for(let e in t)[t[e][0],t[e][1]]=[!1,t[e][0]];else if(s[0]!=e[0]||s[1]!=e[1])for(let e in t)[t[e][0],t[e][1]]=[!1,!1];localStorage.setItem("time",JSON.stringify(s)),localStorage.setItem("shows",JSON.stringify(t))}}$((function(){document.getElementById("format").selectedIndex=parseInt(localStorage.getItem("format")),document.getElementById("info").selectedIndex=parseInt(localStorage.getItem("info")),null!=localStorage.getItem("list")&&(document.getElementById("list").innerHTML=localStorage.getItem("list")),null==localStorage.getItem("shows")&&localStorage.setItem("shows",JSON.stringify({})),TheBigBang(),$("html").append('<script src="js/search.js"><\/script>')})),$(document).ready((function(){$("#left").click((function(){left()})),$("#right").click((function(){right()})),$("#format").change((function(){localStorage.setItem("format",$(this)[0].value),TheBigBang()})),$("#clear").click((function(){clear()})),$("#list").click((function(){list()})),Mousetrap.bind("f",(function(){$("#format").focus()})),Mousetrap.bind("i",(function(){$("#info").focus()})),Mousetrap.bind("c",(function(){clear()})),Mousetrap.bind("l",(function(){list()})),Mousetrap.bind("m",(function(){$("#calendar").focus()})),Mousetrap.bind("n",(function(){right()})),Mousetrap.bind("p",(function(){left()})),Mousetrap.bind("s",(function(){$("#search").focus()})),$("body").keyup((function(e){13==e.keyCode&&"select"==e.target.localName&&e.target.blur()}))})),Date.prototype.getWeek=function(){const e=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate()));return e.setDate(e.getDate()-e.getDay()),Math.ceil((e.valueOf()-new Date(e.getFullYear(),0,1).valueOf())/864e5/7)};
